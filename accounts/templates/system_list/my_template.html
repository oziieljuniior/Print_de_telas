{% extends 'base.html' %}

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

{% block content %}
<div class="container">
    <table class="table" id="my-table">
        <thread>
            <tr>
                <th> ID </th>
                <th> Odd </th>
                <th> Hora da Odd </th>
                <th> Apostadores </th>
            </tr>
        </thread>
        <tbody>
        </tbody>
    </table>
</div>
{% endblock %}

{% block javascript %}
    <script>
        function loadTableData(){
            $.get("{% url 'my_url' %}", function(data){(
                $("#my-table tbody").empty();

                $.each(data, function(index,row)){
                    var $row = $("<tr></tr>");
                    $("<td></td>").text(row.id).appendTo($row);
                    $("<td></td>").text(row.odd).appendTo($row);
                    $("<td></td>").text(row.hora_criacao).appendTo($row);
                    $("<td></td>").text(row.apostadores).appendTo($row);
                    $row.appendTo("#my-table tbody");
                });
            });
        }

        loadTableData();
        setInterval(function(){
            loadTableData();
        }, 3000);
        console.log('LoadTableData() foi chamada pelo setInterval!');
    </script>
{% endblock %}